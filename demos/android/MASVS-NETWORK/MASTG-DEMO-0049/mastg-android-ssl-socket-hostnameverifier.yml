rules:
  - id: mastg-android-ssl-socket-hostnameverifier
    severity: INFO
    languages:
      - java
    metadata:
      summary: Detect usage of SSLSocket API with a HostnameVerifier bound to its SSLSession
    message: ""
    patterns:
      - pattern: |
          SSLSocketFactory $SF = (SSLSocketFactory) $_;
          ...
          $SF.createSocket(..., 443);
          ...
          hostnameVerifier = HttpsURLConnection.getDefaultHostnameVerifier();
          ...
          session = socket.getSession();

