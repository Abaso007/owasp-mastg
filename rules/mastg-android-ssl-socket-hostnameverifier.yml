rules:
  - id: mastg-android-ssl-socket-hostnameverifier
    severity: INFO
    languages:
      - java
    metadata:
      summary: Detect usage of SSLSocket API with a HostnameVerifier bound to its SSLSession
    message: ""
    match:
      any:
        - pattern: SSLSocketFactory.getDefault()
        - pattern: (SSLSocketFactory) $_
        - pattern: $SF.createSocket(...)
        - pattern: HttpsURLConnection.getDefaultHostnameVerifier()
        - pattern: $HNV.verify($_, $_)