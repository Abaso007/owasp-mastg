rules:
  - id: MSTG-TEST-0234-3
    severity: WARNING
    languages:
      - java
    metadata:
      summary: This rule looks for the use of onReceivedSslError and ensures it throws an exception instead of silently muting TLS errors.
    message: Improper use of onReceivedSslError handler
    match:
      any:
        - all:
          - not: |
              $RETURN onReceivedSslError(...) {
              ...
              throw new $EXCEPTION(...);
              ...
              }
          - inside: |
              $RETURN onReceivedSslError(...) {
              ...
              }
          -  $HANDLER.proceed();
